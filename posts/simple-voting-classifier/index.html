<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Simple Voting Classifier | Charles Franzen</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://charlesfranzen.com/posts/simple-voting-classifier/">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><meta name="author" content="Charles Franzen">
<meta property="og:site_name" content="Charles Franzen">
<meta property="og:title" content="Simple Voting Classifier">
<meta property="og:url" content="http://charlesfranzen.com/posts/simple-voting-classifier/">
<meta property="og:description" content="Simple Voting Classifier¶Libraries like Scikit-learn are sometimes equiped with a voting classifier that will allow you to aggregate your machine learning models through voting. If you have a bunch of">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-12-26T11:42:53+08:00">
</head>
<body>
    <section class="social"><ul>
<li><a href="../../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://getnikola.com" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/getnikola" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/getnikola" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
    <div class="post">
        <h1 class="p-name entry-title" itemprop="headline name">Simple Voting Classifier</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2015-12-26T11:42:53+08:00">2015-12-26 11:42</time>
            
                      |  
        <a href="index.ipynb" id="sourcelink">Source</a>

            </div>
            
        </div>
        <div class="body">
            <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simple-Voting-Classifier">Simple Voting Classifier<a class="anchor-link" href="#Simple-Voting-Classifier">¶</a>
</h2>
<p>Libraries like Scikit-learn are sometimes equiped with a voting classifier that will allow you to aggregate your machine learning models through voting. If you have a bunch of models already built, though, voting classifiers can take a very long time to build, as each individual model has to be built again by the new classifier.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<!-- TEASER_END -->
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the case of binary classification with scikit-learn, models that you have built, tuned, and tested are easily aggregated with a simple voting algorithm.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, import the modules:</p>

<pre><code>import numpy as np
from sklearn import metrics</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, generate predictions for each model:</p>

<pre><code>&gt;&gt;&gt; pred = clf.predict(X)
&gt;&gt;&gt; pred2 = clf2.predict(X)

&gt;&gt;&gt; predictions = [pred, pred2]</code></pre>
<p>The numpy array data structure makes it easy to compare the predictions of each classifier and return a new array of the vote results:</p>

<pre><code>def voting_classifier(predictions):
    '''
    returns a numpy array of predictions, based upon votes of input models

    input- list of numpy arrays
    '''
    return (sum(predictions) &gt;= (len(predictions)/2.)).astype(int)

&gt;&gt;&gt; vote_predictions = voting_classifier(predictions)</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have our predictions, it's convenient to streamline evaluation with a function:</p>

<pre><code>def classifier_evaluation(true_labels, predictions):
    '''
    Generates evaluation metrics

    inputs - numpy arrays
    '''
    print 'Acc: ', metrics.accuracy_score(true_labels, predictions), '\n'
    print metrics.confusion_matrix(true_labels, predictions)
    print metrics.classification_report(true_labels, predictions)</code></pre>
<p>Sample output:</p>

<pre><code>&gt;&gt;&gt; classifier_evaluation(y, vote_predictions)

    Acc:  0.816753308129 

[[6634 1284]
 [ 267  279]]
             precision    recall  f1-score   support

        0.0       0.96      0.84      0.90      7918
        1.0       0.18      0.51      0.26       546

avg / total       0.91      0.82      0.85      8464</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And there you have it: a quick and dirty binary voting classifier that doesn't require rebuilding the models.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p><strong>Copyright 2015 Charles Franzen</strong></p>
<p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>

<pre><code>http://www.apache.org/licenses/LICENSE-2.0

</code></pre>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>

</div>
</div>
</div>
    </div>
  </div>

        </div>
                <ul class="pager hidden-print">
<li class="previous">
                <a href="../machine-learning-classifying-us-visa-applications/" rel="prev" title="Machine Learning- Classifying US Visa Applications">Previous post</a>
            </li>
        </ul>
</div>
                    <footer id="footer"><p>Contents © 2015         <a href="mailto:chip.franzen@gmail.com">Charles Franzen</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License
style=" border-width:0 src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
<br>This work by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Charles Franzen</span> is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License
</a>.</p>
            
        </footer>
</div>
    </section><script src="../../assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
